<!DOCTYPE html>
<html>
<body>
  <section class="page container" id="applications" data-test-id="own-applications">
    <span > </span>
    <h1 data-bind="visible: !showMissing(), ltext: 'navigation'" ></h1>
    <div class="invitations" data-bind="if: invites().length">
      <h2 data-bind="ltext: 'application.invites'"></h2>
      <div data-bind="foreach: invites" >
        <div class="invitation">
          <div>
            <h3 data-bind="text: headerText"></h3>
            <span data-bind="ltext: 'inviter'"></span>
            <span data-bind="fullName: inviter"></span>
            <p data-bind="visible: text, text: text, attr: {'data-test-id': 'invitation-text-' + $index()}"></p>
          </div>
          <div>
            <span data-bind="dateString: created"></span>
          </div>
          <div class="invitation-actions">
            <a data-bind="ltext: 'applications.openApplication', attr: {href: '#!/application/' + application.id}" class="btn btn-primary btn-auto" data-test-id="open-application-button"></a>
            <button data-bind="ltext: 'applications.approveInvite', click: $root.approveInvite, enable: lupapisteApp.models.globalAuthModel.ok('approve-invite')"
                    class="btn btn-primary btn-auto" data-test-id="accept-invite-button"></button>
            <a class="command" data-bind="ltext: 'applications.declineInvite', click: $root.declineInvite" data-test-id="decline-invite-button"></a>
          </div>
        </div>
      </div>
    </div>
    <!-- ko if: features.enabled('alueellisetOrganisaatiot-search') && lupapisteApp.models.currentUser.loaded() -->
    <div class="feature" data-bind="component: 'applications-search'">
    </div>
    <!-- /ko -->
    <div data-bind="visible: $data.showFilterControls" class="filter-controls">
      <div>
        <label for="applications-filter-user" data-bind="ltext: 'applications.filter.desc'" class="form-label"></label>
        <select id="applications-filter-user" data-bind="value: filter.user,  options: userOptions,  optionsText: 'name'"></select>
      </div>
      <div>
        <label for="applications-filter-state" data-bind="ltext: 'applications.filter.state-desc'" class="form-label"></label>
        <select id="applications-filter-state" data-bind="value: filter.state, options: stateOptions, optionsText: 'name'"></select>
      </div>
    </div>


      <div data-bind="visible: showRadioTabs" class="radio-tabs">
        <input onfocus="this.blur()" data-bind="checked: filter.kind" type="radio" id="all-radio" name="kind" value="both"/>
        <label for="all-radio" data-bind="ltext: 'applications.both', click: radioTabClick" class="checked radio-label"></label>

        <input onfocus="this.blur()" data-bind="checked: filter.kind" type="radio" id="application-radio" name="kind" value="applications"/>
        <label for="application-radio" data-bind="ltext: 'applications.applications', click: radioTabClick" class="radio-label" ></label>

        <input onfocus="this.blur()" data-bind="checked: filter.kind" type="radio" id="inforequest-radio" name="kind" value="inforequests"/>
        <label for="inforequest-radio" data-bind="ltext: 'applications.inforequests', click: radioTabClick" class="radio-label"></label>

        <div class="clearable">
          <form data-bind="submit: searchNow">
            <input data-bind="attr: {placeholder: loc('application.filter.search')}, textInput: searchField"
                   type="text" id="applications-search" class="form-input text applications-search" />
            <span class="icon_clear ">X</span>
          </form>
        </div>

        <button
          data-bind="click: create"
          data-test-id="applications-create-new"
          class="btn-primary application-create">
          <span data-bind="ltext: 'request.create'"></span><span class="icon add left-align"></span>
        </button>

        <button
          data-bind="click: createWithPrevPermit, visible: authorizationModel.ok('create-application-from-previous-permit')"
          data-test-id="applications-create-new-with-prev-permit"
          class="btn-primary application-from-previous">
          <span data-bind="ltext: 'newRequest.createNewWithPrevPermit'"></span><span class="icon add left-align"></span>
        </button>
      </div>

      <div data-bind="visible: showMissing()" class="applications-empty-state">
        <h1 data-bind="html: missingTitle"></h1>
        <p data-bind="html: missingDesc"></p>
        <div class="missing-wrapper">

          <div class="missing-inforequest-box app-type-box" data-bind="css: {'app-type-box-wide': !authorizationModel.ok('create-application-from-previous-permit')}">
            <h2 data-bind="ltext: 'applications.missing.inforequest.title'"></h2>
            <p data-bind="lhtml: 'applications.missing.inforequest.desc'"></p>
            <button
              data-bind="click: create"
              data-test-id="applications-create-new-inforequest"
              class="btn-primary application-create">
              <span data-bind="ltext: 'newRequest.newInforequest'"></span><span class="icon add left-align"></span>
            </button>
          </div>

          <div class="missing-application-box app-type-box" data-bind="css: {'app-type-box-wide': !authorizationModel.ok('create-application-from-previous-permit')}">
            <h2 data-bind="ltext: 'applications.missing.application.title'"></h2>
            <p data-bind="lhtml: 'applications.missing.application.desc'"></p>
            <button
              data-bind="click: create"
              data-test-id="applications-create-new-application"
              class="btn-primary application-create">
              <span data-bind="ltext: 'newRequest.newApplication'"></span><span class="icon add left-align"></span>
            </button>
          </div>

          <div class="missing-prev-permit-box app-type-box" data-bind="visible: authorizationModel.ok('create-application-from-previous-permit')">
            <h2 data-bind="ltext: 'applications.createWithPrevPermit.title'"></h2>
            <p data-bind="ltext: 'applications.createWithPrevPermit.desc'"></p>
            <button
              data-bind="click: createWithPrevPermit"
              data-test-id="applications-create-with-prev-permit"
              class="btn-primary application-create">
              <span data-bind="ltext: 'newRequest.createNewWithPrevPermit'"></span><span class="icon add left-align"></span>
            </button>
          </div>
        </div>
      </div>

    <div data-bind="visible: showApplicationsList()">
      <table id="applications-list" class="table">
        <thead>
          <tr>
            <th data-col-id="urgent"></th>
            <th data-col-id="indicators"></th>
            <th data-col-id="unseenComments"></th>
            <th data-col-id="newAttachments"></th>
            <th data-col-id="type"></th>
            <th data-col-id="location"></th>
            <th data-col-id="operation"></th>
            <th data-col-id="applicant"></th>
            <th data-col-id="sent"></th>
            <th data-col-id="updated"></th>
            <th data-col-id="status"></th>
            <th data-col-id="authority"></th>
          </tr>
        </thead>
        <tbody>
        </tbody>
      </table>
    </div>


  </section>
</body>
</html>
