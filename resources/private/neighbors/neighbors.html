<!DOCTYPE html>
<html>
<body>
  <section class="page container" id="neighbors">

    <div id="neighbors-content">

      <div class="map map-large" id="neighbors-map"></div>

      <table class="application-neighbors">
        <thead>
          <tr>
            <th data-bind="ltext: 'neighbors.propertyId'"></th>
            <th data-bind="ltext: 'neighbors.owner'"></th>
            <th data-bind="ltext: 'neighbors.status'"></th>
            <th data-bind="ltext: 'neighbors.actions'"></th>
          </tr>
        </thead>
        <tbody data-bind="foreach: neighbors">
          <tr data-bind="attr: {'data-test-id': 'manage-neighbors-email-' + neighbor.owner.email}">
            <td data-bind="text: neighbor.propertyId"></td>
            <td data-bind="with: neighbor.owner">
              <span data-bind="text: name" class="owner-name"></span>
              <span data-bind="text: address.street" class="owner-street"></span>
              <span data-bind="text: address.zip" class="owner-zip"></span>
              <span data-bind="text: address.city" class="owner-city"></span>
              <span data-bind="text: email" class="owner-email"></span>
            </td>
            <td data-bind="with: _.last(status)">
              <span data-bind="text: loc(['neighbor.state', state])" class="status-state"></span>
              <span data-bind="dateTimeString: created" class="status-time"></span>
            </td>
            <td>
              <a data-bind="click: $root.edit, clickBubble: false, ltext: 'neighbors.actions.edit'" data-test-id="manage-neighbors-edit" href="#"></a>
              <a data-bind="click: $root.remove, clickBubble: false, ltext: 'neighbors.actions.remove'" data-test-id="manage-neighbors-remove"href="#"></a>
            </td>
          </tr>
        </tbody>
      </table>

      <button data-bind="click: $root.add, ltext: 'neighbors.add'" data-test-id="manager-neighbors-add" class="btn btn-primary modal"></button>
      <button data-bind="click: $root.done, ltext: 'neighbors.done'" data-test-id="manager-neighbors-done" class="btn"></button>

    </div>

    <div id="dialog-select-owners" class="window autosized">
      <div class="dialog-header">
        <p data-bind="ltext: 'neighbor.owners.title'"></p>
        <p class="dialog-close close">X</p>
      </div>
      <div class="dialog-content">
        <div>
          <h2 data-bind="visible: isPropertyIdAvailable()">
            <span data-bind="ltext: 'neighbors.edit.propertyId'"></span>:
            <span data-bind="text: propertyId"></span>
          </h2>
          <span data-bind="text: loc(['neighbors.owners.status', status()])"></span>
          <img data-bind="visible: isSearching()" src="/img/ajax-loader-16.gif" alt=""/>
        </div>
        <table class="property-owners scrolling-content">
          <thead>
            <tr>
              <th data-bind="ltext: 'neighbors.owner'"></th>
              <th data-bind="ltext: 'neighbors.owner.address'"></th>
              <th data-bind="ltext: 'neighbors.owner.type'"></th>
              <th data-bind="ltext: 'neighbors.actions'"></th>
            </tr>
          </thead>
          <tbody data-bind="foreach: owners">
            <tr>
              <td>
                <!-- ko if: nameOfDeceased -->
                <span data-bind="text nameOfDeceased" class="owner-nameOfDeceased"></span> 
                -<span data-bind="text: loc('neighbors.owner.type.KP'])"></span>
                <!-- /ko -->

                <span data-bind="text: name" class="owner-name"></span>

                <!-- ko if: businessID -->
                (<span data-bind="text: businessID" class="owner-businessID"></span>) 
                <!-- /ko -->
              </td>
              <td>
                <span data-bind="text: street" class="owner-street"></span>
                <span data-bind="text: zip" class="owner-zip"></span>
                <span data-bind="text: city" class="owner-city"></span>
              </td>
              <td data-bind="text: loc(['neighbors.owner.type', type])">
              </td>
              <td>
                <a data-bind="click: $root.select, clickBubble: false, ltext: 'neighbors.actions.select'" data-test-id="manage-neighbors-select" href="#"></a>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div id="dialog-edit-neighbor" class="window autosized">
      <div class="dialog-header">
        <p data-bind="ltext: 'neighbors.edit.title'"></p>
        <p class="dialog-close close">X</p>
      </div>
      <div class="dialog-content">

        <div>
          <span data-bind="text: loc(['neighbors.edit.status', status()])"></span>
        </div>
        <form>
          <label data-bind="ltext: 'neighbors.edit.propertyId'" class="form-label" for="neighbors.edit.propertyId"></label>
          <input data-bind="value: propertyId, enable: status() > statusInit, css: {'error': !propertyIdOk()}, valueUpdate: 'afterkeydown'" class="form-input text long" type="text" id="neighbors.edit.propertyId" data-test-id="neighbors.edit.propertyId" />

          <label data-bind="ltext: 'neighbors.owner.name'" class="form-label" for="neighbors.owner.name"></label>
          <input data-bind="value: name, enable: status() > statusInit" class="form-input text long" type="text" id="neighbors.owner.name" data-test-id="neighbors.edit.name"/>

          <label data-bind="ltext: 'neighbors.owner.address.street'" class="form-label" for="neighbors.owner.address.street"></label>
          <input data-bind="value: street, enable: status() > statusInit" class="form-input text long" type="text" id="neighbors.owner.address.street" />

          <label data-bind="ltext: 'neighbors.owner.address.zip'" class="form-label" for="neighbors.owner.address.zip">
          </label>
          <input data-bind="value: zip, enable: status() > statusInit" class="form-input text long" type="text" id="neighbors.owner.address.zip" />

          <label data-bind="ltext: 'neighbors.owner.address.city'" class="form-label" for="neighbors.owner.address.city"></label>
          <input data-bind="value: city, enable: status() > statusInit" class="form-input text long" type="text" id="neighbors.owner.address.city" />

          <label data-bind="ltext: 'neighbors.owner.email'" class="form-label" for="neighbors.owner.email"></label>
          <input data-bind="value: email, enable: status() > statusInit, css: {'error': !emailOk()}, valueUpdate: 'afterkeydown'" class="form-input text long" type="text" id="neighbors.owner.email" data-test-id="neighbors.edit.email" />
        </form>

        <button data-bind="click: save, enable: ok, ltext: 'neighbors.edit.ok'" class="btn btn-primary btn-dialog" data-test-id="neighbors.edit.ok"></button>
        <button data-bind="ltext: 'neighbors.edit.cancel'" class="btn btn-dialog close"></button>

      </div>
    </div>

  </section>

</body>
</html>
